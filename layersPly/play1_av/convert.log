(RKNN-Toolkit2) user@f9d2ae357807:~/shared/pukTests$ python convert.py puk1.onnx rk3588 fp puk1.rknn
W __init__: rknn-toolkit2 version: 1.6.0+81f21f4d
[1/4] config()
[2/4] load_onnx() puk1.onnx
W load_onnx: It is recommended onnx opset 19, but your onnx model opset is 11!
W load_onnx: Model converted from pytorch, 'opset_version' should be set 19 in torch.onnx.export for successful convert!
Loading : 100%|████████████████████████████████████████████████████| 1/1 [00:00<00:00, 14716.86it/s]
[3/4] build() FP32
I base_optimize ...
I base_optimize done.
I 
I fold_constant ...
I fold_constant done.
I 
I correct_ops ...
I correct_ops done.
I 
I fuse_ops ...
I fuse_ops results:
I     unsqueeze_to_4d_conv: remove node = [], add node = ['/conv/Conv_0_unsqueeze0', '/conv/Conv_0_unsqueeze1']
I     fold_constant ...
I     fold_constant done.
I fuse_ops done.
I 
I sparse_weight ...
I sparse_weight done.
I 
I rknn building ...
I RKNN: [18:44:39.545] compress = 0, conv_eltwise_activation_fuse = 1, global_fuse = 1, multi-core-model-mode = 7, output_optimize = 1,enable_argb_group=0 ,layout_match = 0, pipeline_fuse = 0
I RKNN: librknnc version: 1.6.0 (585b3edcf@2023-12-11T07:42:56)
D RKNN: [18:44:39.545] RKNN is invoked
D RKNN: [18:44:39.545] >>>>>> start: rknn::RKNNExtractCustomOpAttrs
D RKNN: [18:44:39.545] <<<<<<<< end: rknn::RKNNExtractCustomOpAttrs
D RKNN: [18:44:39.545] >>>>>> start: rknn::RKNNSetOpTargetPass
D RKNN: [18:44:39.545] <<<<<<<< end: rknn::RKNNSetOpTargetPass
D RKNN: [18:44:39.545] >>>>>> start: rknn::RKNNBindNorm
D RKNN: [18:44:39.545] <<<<<<<< end: rknn::RKNNBindNorm
D RKNN: [18:44:39.545] >>>>>> start: rknn::RKNNAddFirstConv
D RKNN: [18:44:39.545] <<<<<<<< end: rknn::RKNNAddFirstConv
D RKNN: [18:44:39.545] >>>>>> start: rknn::RKNNEliminateQATDataConvert
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNEliminateQATDataConvert
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNTileGroupConv
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNTileGroupConv
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNAddConvBias
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNAddConvBias
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNTileChannel
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNTileChannel
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNPerChannelPrep
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNPerChannelPrep
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNBnQuant
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNBnQuant
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNFuseOptimizerPass
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNFuseOptimizerPass
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNTurnAutoPad
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNTurnAutoPad
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNInitRNNConst
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNInitRNNConst
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNInitCastConst
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNInitCastConst
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNMultiSurfacePass
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNMultiSurfacePass
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNReplaceConstantTensorPass
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNReplaceConstantTensorPass
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNTilingPass
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNTilingPass
D RKNN: [18:44:39.546] >>>>>> start: OpEmit
D RKNN: [18:44:39.546] <<<<<<<< end: OpEmit
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNLayoutMatchPass
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNLayoutMatchPass
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNAddSecondaryNode
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNAddSecondaryNode
D RKNN: [18:44:39.546] >>>>>> start: OpEmit
D RKNN: [18:44:39.546] <<<<<<<< end: OpEmit
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNProfileAnalysisPass
D RKNN: [18:44:39.546] node: Reshape:/conv/Conv_0_unsqueeze0, Target: CPU
D RKNN: [18:44:39.546] node: Reshape:/conv/Conv_0_unsqueeze1, Target: CPU
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNProfileAnalysisPass
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNOperatorIdGenPass
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNOperatorIdGenPass
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNWeightTransposePass
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNWeightTransposePass
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNCPUWeightTransposePass
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNCPUWeightTransposePass
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNModelBuildPass
D RKNN: [18:44:39.546] RKNNModelBuildPass: [Statistics]
D RKNN: [18:44:39.546] total_regcfg_size     :       832
D RKNN: [18:44:39.546] total_diff_regcfg_size:       864
D RKNN: [18:44:39.546] <<<<<<<< end: rknn::RKNNModelBuildPass
D RKNN: [18:44:39.546] >>>>>> start: rknn::RKNNModelRegCmdbuildPass
D RKNN: [18:44:39.547] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:44:39.547]                                                                 Network Layer Information Table                                                                 
D RKNN: [18:44:39.547] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:44:39.547] ID   OpType           DataType Target InputShape                               OutputShape            DDRCycles    NPUCycles    MaxCycles    TaskNumber   RW(KB)       FullName        
D RKNN: [18:44:39.547] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:44:39.547] 0    InputOperator    FLOAT16  CPU    \                                        (1,1,1000)             0            0            0            0/0          0            InputOperator:input
D RKNN: [18:44:39.547] 1    Reshape          FLOAT16  CPU    (1,1,1000),(4)                           (1,1,1,1000)           0            0            0            0/0          1            Reshape:/conv/Conv_0_unsqueeze0
D RKNN: [18:44:39.547] 2    Conv             FLOAT16  NPU    (1,1,1,1000),(128,1,1,5)                 (1,128,1,996)          11889        5040         11889        1/0          25           Conv:/conv/Conv 
D RKNN: [18:44:39.547] 3    Reshape          FLOAT16  CPU    (1,128,1,996),(3)                        (1,128,996)            0            0            0            0/0          249          Reshape:/conv/Conv_0_unsqueeze1
D RKNN: [18:44:39.547] 4    OutputOperator   FLOAT16  CPU    (1,128,996)                              \                      0            0            0            0/0          249          OutputOperator:2
D RKNN: [18:44:39.547] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:44:39.547] <<<<<<<< end: rknn::RKNNModelRegCmdbuildPass
D RKNN: [18:44:39.547] >>>>>> start: rknn::RKNNMemStatisticsPass
D RKNN: [18:44:39.547] ---------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:44:39.547]                                            Feature Tensor Information Table                                
D RKNN: [18:44:39.547] -----------------------------------------------------------------------------------------------+---------------------------------
D RKNN: [18:44:39.547] ID  User           Tensor                  DataType  DataFormat   OrigShape     NativeShape    |     [Start       End)       Size
D RKNN: [18:44:39.547] -----------------------------------------------------------------------------------------------+---------------------------------
D RKNN: [18:44:39.547] 1   Reshape        input                   FLOAT16   UNDEFINED    (1,1,1000)    (1,1,1000)     | 0x00000000 0x000007d0 0x000007d0
D RKNN: [18:44:39.547] 2   Conv           input_shape4_/conv/Conv FLOAT16   NC1HWC2      (1,1,1,1000)  (1,2,1,1000,8) | 0x00000800 0x00008500 0x00007d00
D RKNN: [18:44:39.547] 3   Reshape        2_shape4                FLOAT16   NC1HWC2      (1,128,1,996) (1,16,1,996,8) | 0x00008500 0x00046900 0x0003e400
D RKNN: [18:44:39.547] 4   OutputOperator 2                       FLOAT16   UNDEFINED    (1,128,996)   (1,128,996)    | 0x00046900*0x00084d00 0x0003e400
D RKNN: [18:44:39.547] -----------------------------------------------------------------------------------------------+---------------------------------
D RKNN: [18:44:39.547] ---------------------------------------------------------------------------------------------------
D RKNN: [18:44:39.547]                                  Const Tensor Information Table                   
D RKNN: [18:44:39.547] -----------------------------------------------------------------+---------------------------------
D RKNN: [18:44:39.547] ID  User    Tensor                        DataType  OrigShape    |     [Start       End)       Size
D RKNN: [18:44:39.547] -----------------------------------------------------------------+---------------------------------
D RKNN: [18:44:39.547] 1   Reshape /conv/Conv_0_unsqueeze0_shape INT64     (4)          | 0x00002800 0x00002820 0x00000020
D RKNN: [18:44:39.547] 2   Conv    conv.weight                   FLOAT16   (128,1,1,5)  | 0x00000000 0x00002800 0x00002800
D RKNN: [18:44:39.547] 3   Reshape /conv/Conv_0_unsqueeze1_shape INT64     (3)          | 0x00002840 0x00002858 0x00000018
D RKNN: [18:44:39.547] -----------------------------------------------------------------+---------------------------------
D RKNN: [18:44:39.547] ----------------------------------------
D RKNN: [18:44:39.547] Total Internal Memory Size: 531.25KB
D RKNN: [18:44:39.547] Total Weight Memory Size: 12.125KB
D RKNN: [18:44:39.547] ----------------------------------------
D RKNN: [18:44:39.547] <<<<<<<< end: rknn::RKNNMemStatisticsPass
I rknn buiding done.
[4/4] export_rknn() puk1.rknn
✔ Done – RKNN saved at: puk1.rknn
(RKNN-Toolkit2) user@f9d2ae357807:~/shared/pukTests$ python convert.py puk2.onnx rk3588 fp puk2.rknn
W __init__: rknn-toolkit2 version: 1.6.0+81f21f4d
[1/4] config()
[2/4] load_onnx() puk2.onnx
W load_onnx: It is recommended onnx opset 19, but your onnx model opset is 11!
W load_onnx: Model converted from pytorch, 'opset_version' should be set 19 in torch.onnx.export for successful convert!
Loading : 100%|████████████████████████████████████████████████████| 5/5 [00:00<00:00, 74367.09it/s]
[3/4] build() FP32
I base_optimize ...
I base_optimize done.
I 
I fold_constant ...
I fold_constant done.
I 
I correct_ops ...
I correct_ops done.
I 
I fuse_ops ...
I fuse_ops results:
I     replace_torch_layernorm: remove node = ['/ln/ReduceMean', '/ln/Sub', '/ln/Pow', '/ln/ReduceMean_1', '/ln/Add', '/ln/Sqrt', '/ln/Div'], add node = ['/ln/ReduceMean_2layer_norm']
I     remove_invalid_mul: remove node = ['/ln/Mul']
I     remove_invalid_add: remove node = ['/ln/Add_1']
I     unsqueeze_to_4d_conv: remove node = [], add node = ['/conv/Conv_0_unsqueeze0', '/conv/Conv_0_unsqueeze1']
I     unsqueeze_to_4d_transpose: remove node = [], add node = ['/Transpose_0_unsqueeze0', '/Transpose_0_unsqueeze1']
I     unsqueeze_to_4d_exlayernorm: remove node = [], add node = ['/ln/ReduceMean_2layer_norm_0_unsqueeze0', '/ln/ReduceMean_2layer_norm_0_unsqueeze1']
I     unsqueeze_to_4d_transpose: remove node = [], add node = ['/Transpose_1_0_unsqueeze0', '/Transpose_1_0_unsqueeze1']
I     fuse_two_reshape: remove node = ['/conv/Conv_0_unsqueeze1', '/Transpose_0_unsqueeze1', '/ln/ReduceMean_2layer_norm_0_unsqueeze1']
I     remove_invalid_reshape: remove node = ['/Transpose_0_unsqueeze0']
I     convert_reshape_to_transpose: remove node = ['/ln/ReduceMean_2layer_norm_0_unsqueeze0'], add node = ['/ln/ReduceMean_2layer_norm_0_unsqueeze0']
I     convert_reshape_to_transpose: remove node = ['/Transpose_1_0_unsqueeze0'], add node = ['/Transpose_1_0_unsqueeze0']
I     fuse_two_transpose: remove node = ['/Transpose', '/Transpose_1_0_unsqueeze0']
I     fold_constant ...
I     fold_constant done.
I fuse_ops done.
I 
I sparse_weight ...
I sparse_weight done.
I 
I rknn building ...
I RKNN: [18:45:02.363] compress = 0, conv_eltwise_activation_fuse = 1, global_fuse = 1, multi-core-model-mode = 7, output_optimize = 1,enable_argb_group=0 ,layout_match = 0, pipeline_fuse = 0
I RKNN: librknnc version: 1.6.0 (585b3edcf@2023-12-11T07:42:56)
D RKNN: [18:45:02.363] RKNN is invoked
D RKNN: [18:45:02.364] >>>>>> start: rknn::RKNNExtractCustomOpAttrs
D RKNN: [18:45:02.364] <<<<<<<< end: rknn::RKNNExtractCustomOpAttrs
D RKNN: [18:45:02.364] >>>>>> start: rknn::RKNNSetOpTargetPass
D RKNN: [18:45:02.364] <<<<<<<< end: rknn::RKNNSetOpTargetPass
D RKNN: [18:45:02.364] >>>>>> start: rknn::RKNNBindNorm
D RKNN: [18:45:02.364] <<<<<<<< end: rknn::RKNNBindNorm
D RKNN: [18:45:02.364] >>>>>> start: rknn::RKNNAddFirstConv
D RKNN: [18:45:02.364] <<<<<<<< end: rknn::RKNNAddFirstConv
D RKNN: [18:45:02.364] >>>>>> start: rknn::RKNNEliminateQATDataConvert
D RKNN: [18:45:02.364] <<<<<<<< end: rknn::RKNNEliminateQATDataConvert
D RKNN: [18:45:02.364] >>>>>> start: rknn::RKNNTileGroupConv
D RKNN: [18:45:02.364] <<<<<<<< end: rknn::RKNNTileGroupConv
D RKNN: [18:45:02.364] >>>>>> start: rknn::RKNNAddConvBias
D RKNN: [18:45:02.364] <<<<<<<< end: rknn::RKNNAddConvBias
D RKNN: [18:45:02.364] >>>>>> start: rknn::RKNNTileChannel
D RKNN: [18:45:02.364] <<<<<<<< end: rknn::RKNNTileChannel
D RKNN: [18:45:02.364] >>>>>> start: rknn::RKNNPerChannelPrep
D RKNN: [18:45:02.364] <<<<<<<< end: rknn::RKNNPerChannelPrep
D RKNN: [18:45:02.364] >>>>>> start: rknn::RKNNBnQuant
D RKNN: [18:45:02.364] <<<<<<<< end: rknn::RKNNBnQuant
D RKNN: [18:45:02.364] >>>>>> start: rknn::RKNNFuseOptimizerPass
D RKNN: [18:45:02.364] <<<<<<<< end: rknn::RKNNFuseOptimizerPass
D RKNN: [18:45:02.364] >>>>>> start: rknn::RKNNTurnAutoPad
D RKNN: [18:45:02.364] <<<<<<<< end: rknn::RKNNTurnAutoPad
D RKNN: [18:45:02.364] >>>>>> start: rknn::RKNNInitRNNConst
D RKNN: [18:45:02.364] <<<<<<<< end: rknn::RKNNInitRNNConst
D RKNN: [18:45:02.364] >>>>>> start: rknn::RKNNInitCastConst
D RKNN: [18:45:02.364] <<<<<<<< end: rknn::RKNNInitCastConst
D RKNN: [18:45:02.365] >>>>>> start: rknn::RKNNMultiSurfacePass
D RKNN: [18:45:02.365] <<<<<<<< end: rknn::RKNNMultiSurfacePass
D RKNN: [18:45:02.365] >>>>>> start: rknn::RKNNReplaceConstantTensorPass
D RKNN: [18:45:02.365] <<<<<<<< end: rknn::RKNNReplaceConstantTensorPass
D RKNN: [18:45:02.365] >>>>>> start: rknn::RKNNTilingPass
D RKNN: [18:45:02.365] <<<<<<<< end: rknn::RKNNTilingPass
D RKNN: [18:45:02.365] >>>>>> start: OpEmit
E RKNN: [18:45:02.365] emitAB_BA_regtasks: not aligned
D RKNN: [18:45:02.365] <<<<<<<< end: OpEmit
D RKNN: [18:45:02.365] >>>>>> start: rknn::RKNNLayoutMatchPass
D RKNN: [18:45:02.365] <<<<<<<< end: rknn::RKNNLayoutMatchPass
D RKNN: [18:45:02.365] >>>>>> start: rknn::RKNNAddSecondaryNode
D RKNN: [18:45:02.365] <<<<<<<< end: rknn::RKNNAddSecondaryNode
D RKNN: [18:45:02.365] >>>>>> start: OpEmit
D RKNN: [18:45:02.365] finish initComputeZoneMap
E RKNN: [18:45:02.393] emitAB_BA_regtasks: not aligned
D RKNN: [18:45:02.393] <<<<<<<< end: OpEmit
D RKNN: [18:45:02.393] >>>>>> start: rknn::RKNNProfileAnalysisPass
D RKNN: [18:45:02.393] node: Reshape:/conv/Conv_0_unsqueeze0, Target: CPU
D RKNN: [18:45:02.393] node: Transpose:/ln/ReduceMean_2layer_norm_0_unsqueeze0, Target: NPU
D RKNN: [18:45:02.393] node: Transpose:/Transpose_1, Target: CPU
D RKNN: [18:45:02.393] node: Reshape:/Transpose_1_0_unsqueeze1, Target: CPU
D RKNN: [18:45:02.393] <<<<<<<< end: rknn::RKNNProfileAnalysisPass
D RKNN: [18:45:02.393] >>>>>> start: rknn::RKNNOperatorIdGenPass
D RKNN: [18:45:02.393] <<<<<<<< end: rknn::RKNNOperatorIdGenPass
D RKNN: [18:45:02.393] >>>>>> start: rknn::RKNNWeightTransposePass
D RKNN: [18:45:02.393] <<<<<<<< end: rknn::RKNNWeightTransposePass
D RKNN: [18:45:02.393] >>>>>> start: rknn::RKNNCPUWeightTransposePass
D RKNN: [18:45:02.393] <<<<<<<< end: rknn::RKNNCPUWeightTransposePass
D RKNN: [18:45:02.393] >>>>>> start: rknn::RKNNModelBuildPass
D RKNN: [18:45:03.290] RKNNModelBuildPass: [Statistics]
D RKNN: [18:45:03.290] total_regcfg_size     :   1699576
D RKNN: [18:45:03.290] total_diff_regcfg_size:    220600
D RKNN: [18:45:03.290] <<<<<<<< end: rknn::RKNNModelBuildPass
D RKNN: [18:45:03.290] >>>>>> start: rknn::RKNNModelRegCmdbuildPass
D RKNN: [18:45:03.304] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:45:03.304]                                                                 Network Layer Information Table                                                                 
D RKNN: [18:45:03.304] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:45:03.304] ID   OpType           DataType Target InputShape                               OutputShape            DDRCycles    NPUCycles    MaxCycles    TaskNumber   RW(KB)       FullName        
D RKNN: [18:45:03.304] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:45:03.304] 0    InputOperator    FLOAT16  CPU    \                                        (1,1,1000)             0            0            0            0/0          0            InputOperator:input.1
D RKNN: [18:45:03.304] 1    Reshape          FLOAT16  CPU    (1,1,1000),(4)                           (1,1,1,1000)           0            0            0            0/0          1            Reshape:/conv/Conv_0_unsqueeze0
D RKNN: [18:45:03.304] 2    Conv             FLOAT16  NPU    (1,1,1,1000),(128,1,1,5)                 (1,128,1,996)          11889        5040         11889        1/0          25           Conv:/conv/Conv 
D RKNN: [18:45:03.304] 3    Transpose        FLOAT16  NPU    (1,128,1,996)                            (996,128,1,1)          21559        0            21559        2/0          249          Transpose:/ln/ReduceMean_2layer_norm_0_unsqueeze0
D RKNN: [18:45:03.304] 4    exLayerNorm      FLOAT16  NPU    (996,128,1,1),(1,128,1,1)                (996,128,1,1)          21570        0            21570        2065/0       249          exLayerNorm:/ln/ReduceMean_2layer_norm
D RKNN: [18:45:03.304] 5    Transpose        FLOAT16  CPU    (996,128,1,1)                            (1,128,1,996)          0            0            0            0/0          249          Transpose:/Transpose_1
D RKNN: [18:45:03.304] 6    Reshape          FLOAT16  CPU    (1,128,1,996),(3)                        (1,128,996)            0            0            0            0/0          249          Reshape:/Transpose_1_0_unsqueeze1
D RKNN: [18:45:03.304] 7    OutputOperator   FLOAT16  CPU    (1,128,996)                              \                      0            0            0            0/0          249          OutputOperator:17
D RKNN: [18:45:03.304] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:45:03.305] <<<<<<<< end: rknn::RKNNModelRegCmdbuildPass
D RKNN: [18:45:03.305] >>>>>> start: rknn::RKNNMemStatisticsPass
D RKNN: [18:45:03.305] ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:45:03.305]                                                          Feature Tensor Information Table                                                     
D RKNN: [18:45:03.305] -----------------------------------------------------------------------------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:03.305] ID  User           Tensor                                                            DataType  DataFormat   OrigShape     NativeShape    |     [Start       End)       Size
D RKNN: [18:45:03.305] -----------------------------------------------------------------------------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:03.305] 1   Reshape        input.1                                                           FLOAT16   UNDEFINED    (1,1,1000)    (1,1,1000)     | 0x00000000 0x000007d0 0x000007d0
D RKNN: [18:45:03.305] 2   Conv           input.1_shape4_/conv/Conv                                         FLOAT16   NC1HWC2      (1,1,1,1000)  (1,2,1,1000,8) | 0x00000800 0x00008500 0x00007d00
D RKNN: [18:45:03.305] 3   Transpose      /conv/Conv_output_0                                               FLOAT16   NC1HWC2      (1,128,1,996) (1,16,1,996,8) | 0x00008500 0x00046900 0x0003e400
D RKNN: [18:45:03.305] 3   Transpose      /conv/Conv_output_0_exSecondary                                   FLOAT16   NC1HWC2      (1,128,1,996) (1,16,1,996,8) | 0x00046900 0x00084d00 0x0003e400
D RKNN: [18:45:03.305] 4   exLayerNorm    /Transpose_output_0_shape4_/ln/ReduceMean_2layer_norm             FLOAT16   NC1HWC2      (996,128,1,1) (996,16,1,1,8) | 0x00084d00 0x000c3100 0x0003e400
D RKNN: [18:45:03.305] 4   exLayerNorm    /Transpose_output_0_shape4_/ln/ReduceMean_2layer_norm_exSecondary FLOAT16   NC1HWC2      (996,128,1,1) (996,56,1,1,8) | 0x000c3100*0x0019cf00 0x000d9e00
D RKNN: [18:45:03.305] 5   Transpose      /ln/Div_output_0_shape4                                           FLOAT16   NC1HWC2      (996,128,1,1) (996,16,1,1,8) | 0x00000000 0x0003e400 0x0003e400
D RKNN: [18:45:03.305] 5   Transpose      /ln/Div_output_0_shape4_exSecondary                               FLOAT16   NCHW         (996,128,1,1) (996,128,1,1)  | 0x0003e400 0x000bac00 0x0007c800
D RKNN: [18:45:03.305] 6   Reshape        17_shape4                                                         FLOAT16   NCHW         (1,128,1,996) (1,128,1,996)  | 0x000bac00 0x000f9000 0x0003e400
D RKNN: [18:45:03.305] 7   OutputOperator 17                                                                FLOAT16   UNDEFINED    (1,128,996)   (1,128,996)    | 0x00000000 0x0003e400 0x0003e400
D RKNN: [18:45:03.305] -----------------------------------------------------------------------------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:03.305] -----------------------------------------------------------------------------------------------------
D RKNN: [18:45:03.305]                                  Const Tensor Information Table                    
D RKNN: [18:45:03.305] -------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:03.305] ID  User    Tensor                          DataType  OrigShape    |     [Start       End)       Size
D RKNN: [18:45:03.305] -------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:03.305] 1   Reshape /conv/Conv_0_unsqueeze0_shape   INT64     (4)          | 0x00002800 0x00002820 0x00000020
D RKNN: [18:45:03.305] 2   Conv    conv.weight                     FLOAT16   (128,1,1,5)  | 0x00000000 0x00002800 0x00002800
D RKNN: [18:45:03.305] 6   Reshape /Transpose_1_0_unsqueeze1_shape INT64     (3)          | 0x00002840 0x00002858 0x00000018
D RKNN: [18:45:03.305] -------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:03.305] ----------------------------------------
D RKNN: [18:45:03.305] Total Internal Memory Size: 1651.75KB
D RKNN: [18:45:03.305] Total Weight Memory Size: 12.125KB
D RKNN: [18:45:03.305] ----------------------------------------
D RKNN: [18:45:03.305] <<<<<<<< end: rknn::RKNNMemStatisticsPass
I rknn buiding done.
[4/4] export_rknn() puk2.rknn
✔ Done – RKNN saved at: puk2.rknn
(RKNN-Toolkit2) user@f9d2ae357807:~/shared/pukTests$ python convert.py puk3.onnx rk3588 fp puk3.rknn
W __init__: rknn-toolkit2 version: 1.6.0+81f21f4d
[1/4] config()
[2/4] load_onnx() puk3.onnx
W load_onnx: It is recommended onnx opset 19, but your onnx model opset is 11!
W load_onnx: Model converted from pytorch, 'opset_version' should be set 19 in torch.onnx.export for successful convert!
Loading : 100%|████████████████████████████████████████████████████| 5/5 [00:00<00:00, 74898.29it/s]
[3/4] build() FP32
I base_optimize ...
I base_optimize done.
I 
I fold_constant ...
I fold_constant done.
I 
I correct_ops ...
I correct_ops done.
I 
I fuse_ops ...
I fuse_ops results:
I     convert_squeeze_to_reshape: remove node = ['/Squeeze'], add node = ['/Squeeze_2reshape']
I     replace_torch_layernorm: remove node = ['/ln/ReduceMean', '/ln/Sub', '/ln/Pow', '/ln/ReduceMean_1', '/ln/Add', '/ln/Sqrt', '/ln/Div'], add node = ['/ln/ReduceMean_2layer_norm']
I     remove_invalid_mul: remove node = ['/ln/Mul']
I     remove_invalid_add: remove node = ['/ln/Add_1']
I     swap_reshape_transpose: remove node = ['/Squeeze_2reshape', '/Transpose'], add node = ['/Transpose', '/Squeeze_2reshape']
I     unsqueeze_to_4d_exlayernorm: remove node = [], add node = ['/ln/ReduceMean_2layer_norm_0_unsqueeze0', '/ln/ReduceMean_2layer_norm_0_unsqueeze1']
I     unsqueeze_to_4d_transpose: remove node = [], add node = ['/Transpose_1_0_unsqueeze0', '/Transpose_1_0_unsqueeze1']
I     fuse_two_reshape: remove node = ['/Squeeze_2reshape', '/ln/ReduceMean_2layer_norm_0_unsqueeze1']
I     convert_reshape_to_transpose: remove node = ['/ln/ReduceMean_2layer_norm_0_unsqueeze0'], add node = ['/ln/ReduceMean_2layer_norm_0_unsqueeze0']
I     convert_reshape_to_transpose: remove node = ['/Transpose_1_0_unsqueeze0'], add node = ['/Transpose_1_0_unsqueeze0']
I     fuse_two_transpose: remove node = ['/Transpose', '/Transpose_1_0_unsqueeze0']
I     fold_constant ...
I     fold_constant done.
I fuse_ops done.
I 
I sparse_weight ...
I sparse_weight done.
I 
I rknn building ...
I RKNN: [18:45:13.188] compress = 0, conv_eltwise_activation_fuse = 1, global_fuse = 1, multi-core-model-mode = 7, output_optimize = 1,enable_argb_group=0 ,layout_match = 0, pipeline_fuse = 0
I RKNN: librknnc version: 1.6.0 (585b3edcf@2023-12-11T07:42:56)
D RKNN: [18:45:13.188] RKNN is invoked
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNExtractCustomOpAttrs
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNExtractCustomOpAttrs
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNSetOpTargetPass
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNSetOpTargetPass
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNBindNorm
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNBindNorm
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNAddFirstConv
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNAddFirstConv
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNEliminateQATDataConvert
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNEliminateQATDataConvert
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNTileGroupConv
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNTileGroupConv
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNAddConvBias
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNAddConvBias
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNTileChannel
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNTileChannel
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNPerChannelPrep
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNPerChannelPrep
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNBnQuant
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNBnQuant
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNFuseOptimizerPass
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNFuseOptimizerPass
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNTurnAutoPad
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNTurnAutoPad
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNInitRNNConst
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNInitRNNConst
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNInitCastConst
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNInitCastConst
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNMultiSurfacePass
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNMultiSurfacePass
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNReplaceConstantTensorPass
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNReplaceConstantTensorPass
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNTilingPass
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNTilingPass
D RKNN: [18:45:13.189] >>>>>> start: OpEmit
E RKNN: [18:45:13.189] emitAB_BA_regtasks: not aligned
D RKNN: [18:45:13.189] <<<<<<<< end: OpEmit
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNLayoutMatchPass
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNLayoutMatchPass
D RKNN: [18:45:13.189] >>>>>> start: rknn::RKNNAddSecondaryNode
D RKNN: [18:45:13.189] <<<<<<<< end: rknn::RKNNAddSecondaryNode
D RKNN: [18:45:13.189] >>>>>> start: OpEmit
D RKNN: [18:45:13.189] finish initComputeZoneMap
E RKNN: [18:45:13.214] emitAB_BA_regtasks: not aligned
D RKNN: [18:45:13.214] <<<<<<<< end: OpEmit
D RKNN: [18:45:13.214] >>>>>> start: rknn::RKNNProfileAnalysisPass
D RKNN: [18:45:13.214] node: Transpose:/ln/ReduceMean_2layer_norm_0_unsqueeze0, Target: CPU
D RKNN: [18:45:13.214] node: Transpose:/Transpose_1, Target: CPU
D RKNN: [18:45:13.214] node: Reshape:/Transpose_1_0_unsqueeze1, Target: CPU
D RKNN: [18:45:13.214] <<<<<<<< end: rknn::RKNNProfileAnalysisPass
D RKNN: [18:45:13.214] >>>>>> start: rknn::RKNNOperatorIdGenPass
D RKNN: [18:45:13.214] <<<<<<<< end: rknn::RKNNOperatorIdGenPass
D RKNN: [18:45:13.214] >>>>>> start: rknn::RKNNWeightTransposePass
D RKNN: [18:45:13.214] <<<<<<<< end: rknn::RKNNWeightTransposePass
D RKNN: [18:45:13.214] >>>>>> start: rknn::RKNNCPUWeightTransposePass
D RKNN: [18:45:13.214] <<<<<<<< end: rknn::RKNNCPUWeightTransposePass
D RKNN: [18:45:13.214] >>>>>> start: rknn::RKNNModelBuildPass
D RKNN: [18:45:14.105] RKNNModelBuildPass: [Statistics]
D RKNN: [18:45:14.105] total_regcfg_size     :   1698472
D RKNN: [18:45:14.105] total_diff_regcfg_size:    219496
D RKNN: [18:45:14.105] <<<<<<<< end: rknn::RKNNModelBuildPass
D RKNN: [18:45:14.105] >>>>>> start: rknn::RKNNModelRegCmdbuildPass
D RKNN: [18:45:14.120] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:45:14.120]                                                                 Network Layer Information Table                                                                 
D RKNN: [18:45:14.120] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:45:14.120] ID   OpType           DataType Target InputShape                               OutputShape            DDRCycles    NPUCycles    MaxCycles    TaskNumber   RW(KB)       FullName        
D RKNN: [18:45:14.120] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:45:14.120] 0    InputOperator    FLOAT16  CPU    \                                        (1,1,1000,1)           0            0            0            0/0          0            InputOperator:input.1
D RKNN: [18:45:14.120] 1    Conv             FLOAT16  NPU    (1,1,1000,1),(128,1,5,1)                 (1,128,996,1)          11297        5040         11297        1/0          11           Conv:/conv/Conv 
D RKNN: [18:45:14.120] 2    Transpose        FLOAT16  CPU    (1,128,996,1)                            (996,128,1,1)          0            0            0            0/0          249          Transpose:/ln/ReduceMean_2layer_norm_0_unsqueeze0
D RKNN: [18:45:14.120] 3    exLayerNorm      FLOAT16  NPU    (996,128,1,1),(1,128,1,1)                (996,128,1,1)          21570        0            21570        2065/0       249          exLayerNorm:/ln/ReduceMean_2layer_norm
D RKNN: [18:45:14.120] 4    Transpose        FLOAT16  CPU    (996,128,1,1)                            (1,128,1,996)          0            0            0            0/0          249          Transpose:/Transpose_1
D RKNN: [18:45:14.120] 5    Reshape          FLOAT16  CPU    (1,128,1,996),(3)                        (1,128,996)            0            0            0            0/0          249          Reshape:/Transpose_1_0_unsqueeze1
D RKNN: [18:45:14.120] 6    OutputOperator   FLOAT16  CPU    (1,128,996)                              \                      0            0            0            0/0          249          OutputOperator:18
D RKNN: [18:45:14.120] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:45:14.120] <<<<<<<< end: rknn::RKNNModelRegCmdbuildPass
D RKNN: [18:45:14.120] >>>>>> start: rknn::RKNNMemStatisticsPass
D RKNN: [18:45:14.120] ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:45:14.120]                                                          Feature Tensor Information Table                                                     
D RKNN: [18:45:14.120] -----------------------------------------------------------------------------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:14.120] ID  User           Tensor                                                            DataType  DataFormat   OrigShape     NativeShape    |     [Start       End)       Size
D RKNN: [18:45:14.120] -----------------------------------------------------------------------------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:14.120] 1   Conv           input.1                                                           FLOAT16   NC1HWC2      (1,1,1000,1)  (1,8,1000,1,1) | 0x00000000 0x00003e80 0x00003e80
D RKNN: [18:45:14.120] 2   Transpose      /conv/Conv_output_0                                               FLOAT16   NC1HWC2      (1,128,996,1) (1,16,996,1,8) | 0x00003e80 0x00042280 0x0003e400
D RKNN: [18:45:14.120] 3   exLayerNorm    /Transpose_output_0_shape4_/ln/ReduceMean_2layer_norm             FLOAT16   NC1HWC2      (996,128,1,1) (996,16,1,1,8) | 0x00042280 0x00080680 0x0003e400
D RKNN: [18:45:14.120] 3   exLayerNorm    /Transpose_output_0_shape4_/ln/ReduceMean_2layer_norm_exSecondary FLOAT16   NC1HWC2      (996,128,1,1) (996,56,1,1,8) | 0x00080680*0x0015a480 0x000d9e00
D RKNN: [18:45:14.120] 4   Transpose      /ln/Div_output_0_shape4                                           FLOAT16   NC1HWC2      (996,128,1,1) (996,16,1,1,8) | 0x00000000 0x0003e400 0x0003e400
D RKNN: [18:45:14.120] 4   Transpose      /ln/Div_output_0_shape4_exSecondary                               FLOAT16   NCHW         (996,128,1,1) (996,128,1,1)  | 0x0003e400 0x000bac00 0x0007c800
D RKNN: [18:45:14.120] 5   Reshape        18_shape4                                                         FLOAT16   NCHW         (1,128,1,996) (1,128,1,996)  | 0x000bac00 0x000f9000 0x0003e400
D RKNN: [18:45:14.120] 6   OutputOperator 18                                                                FLOAT16   UNDEFINED    (1,128,996)   (1,128,996)    | 0x00000000 0x0003e400 0x0003e400
D RKNN: [18:45:14.120] -----------------------------------------------------------------------------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:14.120] -----------------------------------------------------------------------------------------------------
D RKNN: [18:45:14.120]                                  Const Tensor Information Table                    
D RKNN: [18:45:14.120] -------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:14.120] ID  User    Tensor                          DataType  OrigShape    |     [Start       End)       Size
D RKNN: [18:45:14.120] -------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:14.120] 1   Conv    conv.weight                     FLOAT16   (128,1,5,1)  | 0x00000000 0x00002800 0x00002800
D RKNN: [18:45:14.120] 5   Reshape /Transpose_1_0_unsqueeze1_shape INT64     (3)          | 0x00002800 0x00002818 0x00000018
D RKNN: [18:45:14.120] -------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:14.120] ----------------------------------------
D RKNN: [18:45:14.120] Total Internal Memory Size: 1385.12KB
D RKNN: [18:45:14.120] Total Weight Memory Size: 12.0625KB
D RKNN: [18:45:14.120] ----------------------------------------
D RKNN: [18:45:14.120] <<<<<<<< end: rknn::RKNNMemStatisticsPass
I rknn buiding done.
[4/4] export_rknn() puk3.rknn
✔ Done – RKNN saved at: puk3.rknn
(RKNN-Toolkit2) user@f9d2ae357807:~/shared/pukTests$ python convert.py puk4.onnx rk3588 fp puk4.rknn
W __init__: rknn-toolkit2 version: 1.6.0+81f21f4d
[1/4] config()
[2/4] load_onnx() puk4.onnx
W load_onnx: It is recommended onnx opset 19, but your onnx model opset is 11!
W load_onnx: Model converted from pytorch, 'opset_version' should be set 19 in torch.onnx.export for successful convert!
Loading : 100%|████████████████████████████████████████████████████| 5/5 [00:00<00:00, 69212.94it/s]
[3/4] build() FP32
I base_optimize ...
I base_optimize done.
I 
I fold_constant ...
I fold_constant done.
I 
I correct_ops ...
I correct_ops done.
I 
I fuse_ops ...
I fuse_ops results:
I     convert_squeeze_to_reshape: remove node = ['/Squeeze'], add node = ['/Squeeze_2reshape']
I     replace_torch_layernorm: remove node = ['/ln/ReduceMean', '/ln/Sub', '/ln/Pow', '/ln/ReduceMean_1', '/ln/Add', '/ln/Sqrt', '/ln/Div'], add node = ['/ln/ReduceMean_2layer_norm']
I     remove_invalid_mul: remove node = ['/ln/Mul']
I     remove_invalid_add: remove node = ['/ln/Add_1']
I     swap_reshape_transpose: remove node = ['/Squeeze_2reshape', '/Transpose'], add node = ['/Transpose', '/Squeeze_2reshape']
I     unsqueeze_to_4d_exlayernorm: remove node = [], add node = ['/ln/ReduceMean_2layer_norm_0_unsqueeze0', '/ln/ReduceMean_2layer_norm_0_unsqueeze1']
I     unsqueeze_to_4d_transpose: remove node = [], add node = ['/Transpose_1_0_unsqueeze0', '/Transpose_1_0_unsqueeze1']
I     fuse_two_reshape: remove node = ['/Squeeze_2reshape', '/ln/ReduceMean_2layer_norm_0_unsqueeze1']
I     convert_reshape_to_transpose: remove node = ['/ln/ReduceMean_2layer_norm_0_unsqueeze0'], add node = ['/ln/ReduceMean_2layer_norm_0_unsqueeze0']
I     convert_reshape_to_transpose: remove node = ['/Transpose_1_0_unsqueeze0'], add node = ['/Transpose_1_0_unsqueeze0']
I     fuse_two_transpose: remove node = ['/Transpose', '/Transpose_1_0_unsqueeze0']
I     fold_constant ...
I     fold_constant done.
I fuse_ops done.
I 
I sparse_weight ...
I sparse_weight done.
I 
I rknn building ...
I RKNN: [18:45:22.220] compress = 0, conv_eltwise_activation_fuse = 1, global_fuse = 1, multi-core-model-mode = 7, output_optimize = 1,enable_argb_group=0 ,layout_match = 0, pipeline_fuse = 0
I RKNN: librknnc version: 1.6.0 (585b3edcf@2023-12-11T07:42:56)
D RKNN: [18:45:22.220] RKNN is invoked
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNExtractCustomOpAttrs
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNExtractCustomOpAttrs
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNSetOpTargetPass
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNSetOpTargetPass
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNBindNorm
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNBindNorm
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNAddFirstConv
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNAddFirstConv
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNEliminateQATDataConvert
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNEliminateQATDataConvert
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNTileGroupConv
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNTileGroupConv
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNAddConvBias
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNAddConvBias
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNTileChannel
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNTileChannel
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNPerChannelPrep
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNPerChannelPrep
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNBnQuant
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNBnQuant
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNFuseOptimizerPass
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNFuseOptimizerPass
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNTurnAutoPad
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNTurnAutoPad
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNInitRNNConst
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNInitRNNConst
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNInitCastConst
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNInitCastConst
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNMultiSurfacePass
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNMultiSurfacePass
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNReplaceConstantTensorPass
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNReplaceConstantTensorPass
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNTilingPass
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNTilingPass
D RKNN: [18:45:22.221] >>>>>> start: OpEmit
E RKNN: [18:45:22.221] emitAB_BA_regtasks: not aligned
D RKNN: [18:45:22.221] <<<<<<<< end: OpEmit
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNLayoutMatchPass
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNLayoutMatchPass
D RKNN: [18:45:22.221] >>>>>> start: rknn::RKNNAddSecondaryNode
D RKNN: [18:45:22.221] <<<<<<<< end: rknn::RKNNAddSecondaryNode
D RKNN: [18:45:22.221] >>>>>> start: OpEmit
D RKNN: [18:45:22.221] finish initComputeZoneMap
E RKNN: [18:45:22.245] emitAB_BA_regtasks: not aligned
D RKNN: [18:45:22.245] <<<<<<<< end: OpEmit
D RKNN: [18:45:22.245] >>>>>> start: rknn::RKNNProfileAnalysisPass
D RKNN: [18:45:22.245] node: Transpose:/ln/ReduceMean_2layer_norm_0_unsqueeze0, Target: NPU
D RKNN: [18:45:22.245] node: Transpose:/Transpose_1, Target: CPU
D RKNN: [18:45:22.245] node: Reshape:/Transpose_1_0_unsqueeze1, Target: CPU
D RKNN: [18:45:22.245] <<<<<<<< end: rknn::RKNNProfileAnalysisPass
D RKNN: [18:45:22.246] >>>>>> start: rknn::RKNNOperatorIdGenPass
D RKNN: [18:45:22.246] <<<<<<<< end: rknn::RKNNOperatorIdGenPass
D RKNN: [18:45:22.246] >>>>>> start: rknn::RKNNWeightTransposePass
D RKNN: [18:45:22.246] <<<<<<<< end: rknn::RKNNWeightTransposePass
D RKNN: [18:45:22.246] >>>>>> start: rknn::RKNNCPUWeightTransposePass
D RKNN: [18:45:22.246] <<<<<<<< end: rknn::RKNNCPUWeightTransposePass
D RKNN: [18:45:22.246] >>>>>> start: rknn::RKNNModelBuildPass
D RKNN: [18:45:23.138] RKNNModelBuildPass: [Statistics]
D RKNN: [18:45:23.138] total_regcfg_size     :   1699576
D RKNN: [18:45:23.138] total_diff_regcfg_size:    220600
D RKNN: [18:45:23.138] <<<<<<<< end: rknn::RKNNModelBuildPass
D RKNN: [18:45:23.138] >>>>>> start: rknn::RKNNModelRegCmdbuildPass
D RKNN: [18:45:23.152] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:45:23.152]                                                                 Network Layer Information Table                                                                 
D RKNN: [18:45:23.152] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:45:23.152] ID   OpType           DataType Target InputShape                               OutputShape            DDRCycles    NPUCycles    MaxCycles    TaskNumber   RW(KB)       FullName        
D RKNN: [18:45:23.152] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:45:23.152] 0    InputOperator    FLOAT16  CPU    \                                        (1,1,1,1000)           0            0            0            0/0          0            InputOperator:input.1
D RKNN: [18:45:23.152] 1    Conv             FLOAT16  NPU    (1,1,1,1000),(128,1,1,5)                 (1,128,1,996)          11297        5040         11297        1/0          11           Conv:/conv/Conv 
D RKNN: [18:45:23.152] 2    Transpose        FLOAT16  NPU    (1,128,1,996)                            (996,128,1,1)          21559        0            21559        2/0          249          Transpose:/ln/ReduceMean_2layer_norm_0_unsqueeze0
D RKNN: [18:45:23.152] 3    exLayerNorm      FLOAT16  NPU    (996,128,1,1),(1,128,1,1)                (996,128,1,1)          21570        0            21570        2065/0       249          exLayerNorm:/ln/ReduceMean_2layer_norm
D RKNN: [18:45:23.152] 4    Transpose        FLOAT16  CPU    (996,128,1,1)                            (1,128,1,996)          0            0            0            0/0          249          Transpose:/Transpose_1
D RKNN: [18:45:23.152] 5    Reshape          FLOAT16  CPU    (1,128,1,996),(3)                        (1,128,996)            0            0            0            0/0          249          Reshape:/Transpose_1_0_unsqueeze1
D RKNN: [18:45:23.152] 6    OutputOperator   FLOAT16  CPU    (1,128,996)                              \                      0            0            0            0/0          249          OutputOperator:18
D RKNN: [18:45:23.152] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:45:23.152] <<<<<<<< end: rknn::RKNNModelRegCmdbuildPass
D RKNN: [18:45:23.152] >>>>>> start: rknn::RKNNMemStatisticsPass
D RKNN: [18:45:23.152] ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
D RKNN: [18:45:23.152]                                                          Feature Tensor Information Table                                                     
D RKNN: [18:45:23.152] -----------------------------------------------------------------------------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:23.152] ID  User           Tensor                                                            DataType  DataFormat   OrigShape     NativeShape    |     [Start       End)       Size
D RKNN: [18:45:23.152] -----------------------------------------------------------------------------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:23.152] 1   Conv           input.1                                                           FLOAT16   NC1HWC2      (1,1,1,1000)  (1,1,1,1000,1) | 0x00000000 0x000007d0 0x000007d0
D RKNN: [18:45:23.152] 2   Transpose      /conv/Conv_output_0                                               FLOAT16   NC1HWC2      (1,128,1,996) (1,16,1,996,8) | 0x00000800 0x0003ec00 0x0003e400
D RKNN: [18:45:23.152] 2   Transpose      /conv/Conv_output_0_exSecondary                                   FLOAT16   NC1HWC2      (1,128,1,996) (1,16,1,996,8) | 0x0003ec00 0x0007d000 0x0003e400
D RKNN: [18:45:23.152] 3   exLayerNorm    /Transpose_output_0_shape4_/ln/ReduceMean_2layer_norm             FLOAT16   NC1HWC2      (996,128,1,1) (996,16,1,1,8) | 0x0007d000 0x000bb400 0x0003e400
D RKNN: [18:45:23.152] 3   exLayerNorm    /Transpose_output_0_shape4_/ln/ReduceMean_2layer_norm_exSecondary FLOAT16   NC1HWC2      (996,128,1,1) (996,56,1,1,8) | 0x000bb400*0x00195200 0x000d9e00
D RKNN: [18:45:23.152] 4   Transpose      /ln/Div_output_0_shape4                                           FLOAT16   NC1HWC2      (996,128,1,1) (996,16,1,1,8) | 0x00000000 0x0003e400 0x0003e400
D RKNN: [18:45:23.152] 4   Transpose      /ln/Div_output_0_shape4_exSecondary                               FLOAT16   NCHW         (996,128,1,1) (996,128,1,1)  | 0x0003e400 0x000bac00 0x0007c800
D RKNN: [18:45:23.152] 5   Reshape        18_shape4                                                         FLOAT16   NCHW         (1,128,1,996) (1,128,1,996)  | 0x000bac00 0x000f9000 0x0003e400
D RKNN: [18:45:23.152] 6   OutputOperator 18                                                                FLOAT16   UNDEFINED    (1,128,996)   (1,128,996)    | 0x00000000 0x0003e400 0x0003e400
D RKNN: [18:45:23.152] -----------------------------------------------------------------------------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:23.152] -----------------------------------------------------------------------------------------------------
D RKNN: [18:45:23.152]                                  Const Tensor Information Table                    
D RKNN: [18:45:23.152] -------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:23.152] ID  User    Tensor                          DataType  OrigShape    |     [Start       End)       Size
D RKNN: [18:45:23.152] -------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:23.152] 1   Conv    conv.weight                     FLOAT16   (128,1,1,5)  | 0x00000000 0x00002800 0x00002800
D RKNN: [18:45:23.152] 5   Reshape /Transpose_1_0_unsqueeze1_shape INT64     (3)          | 0x00002800 0x00002818 0x00000018
D RKNN: [18:45:23.152] -------------------------------------------------------------------+---------------------------------
D RKNN: [18:45:23.152] ----------------------------------------
D RKNN: [18:45:23.152] Total Internal Memory Size: 1620.5KB
D RKNN: [18:45:23.152] Total Weight Memory Size: 12.0625KB
D RKNN: [18:45:23.152] ----------------------------------------
D RKNN: [18:45:23.152] <<<<<<<< end: rknn::RKNNMemStatisticsPass
I rknn buiding done.
[4/4] export_rknn() puk4.rknn
✔ Done – RKNN saved at: puk4.rknn
